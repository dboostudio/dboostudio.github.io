---
layout: post
author: Dboo
categories: FastCampus_DB
title: <패스트캠퍼스> 데이터베이스와 SQLD CH1. 데이터베이스(1)
tags: LectureNote Fastcampus Database SQL
---

## 데이터베이스

1. 컴퓨터 시스템에 전자적으로 저장된 체계적 데이터의 모음
2. 초기엔 과학적인 용도로 사용했지만, 현재는 데이터를 저장하고 조회하는 용도로 많이 사용함.

### 동시성제어
- 데이터베이스의 동시성 : 여러 사용자가 동시에 사용할 수 있다.
- 동시성 제어란, 여러 사용자가 같은 데이터베이스에 갱신을 하려고 할 때 충돌하지 않도록 해주는 것.

### 데이터베이스의 종류

- 데이터 저장 방식에 따른 분류

|:-:|:-:|
|종류|설명|
|-|-|
|계층형 DB|계층구조로 데이터관리, 최초의 현대적 DB|
|관계형 DB|2차원의 표형식으로 데이터 관리, 가장 널리 사용됨|
|객체지향형 DB|아직 널리 사용되지 않음|
|NOSQL DB|Not Only SQL, 최근 각광|

## 관계형 데이터베이스

관계형 DB는 키:값 의 간단한 관계를 테이블화 시킨 매우 간단한 원칙을 가지며 RDB라고 부른다.

- 관계형 모델
1. 관계형 모델은 집합론에 기반을 둔 일종의 데이터베이스 모델이며, 에드거 커드에 의해 최초로 제안됨
2. 행렬을 가진 테이블에 데이터를 저장함.
3. 각 테이블에는 각 행(row)를 식별하는 기본키(Primary Key)가 있음
4. 열(Column)은 Field 혹은 Attribute라고도 불림, 행(Row)는 Recored 혹은 Tuple로 불림

### SQL 기초지식
1. SQL은 RDBMS의 데이터를 관리하기 위해 설계된 프로그래밍 언어
2. 자료검색, 관리, 스키마 생성과 수정, 데이터베이스 객체 접근 조정관리를 위해 고안되었다.

### Syntax

- SELECT
~~~sql
SELECT *
FROM 고객연락처
WHERE 연락처구분 = '이메일'
  AND 연락처 NOT LIKE '@%' --연락처가 @로 시작하면 안된다.
  AND 연락처 NOT LIKE '%@' --연락처가 @로 끝나면 안된다.
  AND 연락처 LIKE '%@%'; --연락처 중간에 @가 있어야 한다.
~~~

- INSERT
~~~sql
INSERT
  INTO 고객연락처
    (순번, 고객아이디, 고객명, 연락처구분, 연락처)
  VALUES
    (7, 'dboo', 디부, '이메일', dboo.studio@gmail.com);
~~~

- UPDATE
~~~sql
UPDATE 고객연락처
  SET 연락처 = 'dboo.studio@gmail.com'
  WHERE 순번 = 1;
~~~

- DELETE
~~~sql
DELETE
  FROM 고객연락처
  WHERE 순번 = 1;
~~~

### DB vs DBMS

- 관계형 데이터베이스를 사용하기 위해 DBMS를 설치해야 하며 대표적인 DBMS로는 Oracle, MySQL, SQL S
erver, PostgreSQL 등이 있다.
- DBMS는 데이터베이스 자체는 아니다. 데이터베이스의 기능 및 구조를 실현시키기위한 구체적인 소프트웨어이다.

## 데이터베이스 아키텍처

### 가용성과 확장성

- 가용성이란?

1. 가용성이란 서버와 네트워크, 프로그램 등의 정보시스템이 정상적으로 사용 가능한 정로를 말한다.
2. 가용성을 수식으로 표현할 경우, 정상사용시간/전체사용시간 이다.

- 확장성이란?

1. 확장성이란 IT시스템에서 대규모적인 재설계 및 재설치 없이 얼마나 확장이 쉽고 가능한지에 대한 용이성이다.

### DB 다중화

1. 다른 컴포넌트에 비해 다중화가 어려움
2. 영속(Persistence)계층의 특성
  - 데이터의 장기간 보존 필요
  - 데이터 다중화 시 갱신을 통한 정합성 필요

- DB 다중화 유형
DB 서버는 업무적, 기술적, 경제적 측면을 모두 고려하여 선택해야한다.

|:-:|:-:|
|유형|설명|
|-|-|
|Active-Active|- 두개의 DBMS엔진 서버가 동시에 가동됨 <br>- 저장소는 한곳을 바라봄(저장소1개)|
|Active-Standby|- 평소에 Acitve만 운영하고 나머지는 Standby상태<br>- 저장소는 한곳을 바라봄|
|리플리케이션|- DB서버와 저장소를 하나 세트로 하여 준비<br>- 데이터 동기화가 중요<br>- 리플리케이션은 DB서버와 저장소가 동시에 사용 불능일 때<br>서비스를 계속 할 수 있게 해주는 가용성이 높은 아키텍처<br>(주로 DR 시스템에 사용됨)|

#### Acitve-Active 구성 다중화

DB엔진서버1 -> 저장소 <- DB엔진서버2

1. 장애 발생 시, Downtime이 거의 없다고 해도 무방하다.
2. 하나의 서버가 다운되어도, 나머지 하나가 계속 처리한다.
3. 2대의 서버가 운영되므로 성능상으로도 유리하다.

- DB엔진서버 1번에 장애발생시, DB엔진서버2가 Active상태로 있으므로 업무처리가 가능하다.
- 저장소에 병목현상있을 시, 순간적 성능문제가 발생하는 경우가 있다.
- Oracle DBMS의 RAC가 대표적인 Acitve-Active 다중화 제품이다.
- Tibero는 TAC라는 Active-Active 다중화 기술을 지원한다.

#### Active-Standby 구성 다중화

DB엔진서버1 -> 저장소 <- DB엔진서버2(Stnadby)

1. 평소에는 Active 서버로만 업무를 처리함.
2. Active서버가 장애 상황이 된 경우 Standby가 업무를 처리하며 서버 전환시 Downtime이 존재함.
3. 성능적으로 Active-Active보다 효율성이 떨어진다.

- Cold-Standby의 경우는 Active서버가 장애시에만 작동
- Hot-Standby의 경우는 평소에도 Standby서버가 작동

#### 리플리케이션 다중화

DB엔진서버1 -> 저장소1 (Acitve Set) // DB엔진서버2 -> 저장소2 (Stanby Set)

1. Active-Active, Active-Standby는 저장소가 하나를 바라보기 때문에 저장소에 어떤 문제가 생겼을
시, 바로 장애 상황이 발생한다.
2. 리플리케이션 방식은 DB와 저장소를 모두 다중화하는 방식이다.

- DB엔진서버1, 2는 거의 실시간으로 데이터를 동기화한다.
- Active세트와 Stanby세트는 서로 다른 지역에 서버를 설치한다.
- 금융기관, 공공기관에서 시스템 위험분산의 대책으로 주로 사용된다.
- 실시간 데이터 동기화로 성능 이슈가 발생할 수 있다.
- 비용이 매우 많이 들어간다.

### 성능추구를 위한 다중화

- Shard Disk vs Shard Nothing
- 저장소를 공유하는지 여부

|:-:|:-:|
|Shared Disk|Shared Nothing|
|-|-|
|- Active-Active 구성 DB<br>- 저장소 공유로 인한 병목현상 발생<br>-DB서버를 늘려도 한계점에 도달|- 서버와 저장소 세트를 늘려 병렬처리<br>- 세트 갯수에 비례하여 처리율이 증가<br>- DB서버 다운시, 커버링 전략 필요<br>- 샤딩기술이 대표적인 Shared Nothing기술|

#### Shard
- 데이터베이스 샤드(database shard)는 데이터베이스의 수평분할이다. 개개의 파티션은 샤드(shard)또는
데이터베이스 샤드라고 부른다. 각 샤드는 개개의 데이터베이스 서버 인스턴스에서 부하 분산을 위해 보유한다.
- 데이터베이스 내의 일부 데이터는 모든 샤드에 존재하지만 일부는 하나의 샤드에만 존재한다. 각 샤드는 이 데
이터 부분을 위해 하나의 "소스"로서 동작한다.

## 아키텍처 설계 전략

1. 가용성, 신뢰성, 재해대책, 성능, 보안, 조직, 비용등 다양한 조건을 고려해야한다.
2. 해당 비즈니스의 성장성이나 사용자 유입예측도 감안해야 한다.
3. 한번 구축하면 변경 시 비용과 시간이 소요된다.

![](/assets/img/LectureNote/FastCampus/db-aio/architecture-strategy.png)
